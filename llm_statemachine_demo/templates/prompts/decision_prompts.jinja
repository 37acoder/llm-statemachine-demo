{% autoescape off %}
---Current Information---
current_state:
  name: "{{ now.name }}"
  description: "{{ now.description }}"
  data_collected:
    {% for k, v in data_collected.items() %}
    - key: "{{ k }}"
      value: "{{ v }}"
    {% endfor %}
  data_need_to_collect: {% if not data_need_to_collect %} empty  {% endif %}
    {% for item in data_need_to_collect %}
      - key: "{{ item.key }}"
        type: "{{ item.data_type }}"
        description: "{{ item.description }}"
    {% endfor %}
available_next_states:
  {% for path in now.paths %}
  - state:
      name: "{{ path.to_node.name }}"
      description: "{{ path.to_node.description }}"
      is_need_reply: "{{ path.need_llm_reply }}"
      reply_style: "{{ path.llm_reply_guidance }}"
      reply_example: "{{ path.reply_example }}"
      condition: "{{ path.conditions }}"
  {% endfor %}
history:
{% for item in history %}
  - message:
      role: "{{ item.role }}"
      content: "{{ item.content }}"
{% endfor %}
---Response Format---
<response>
        <data-collected> // the data extracted from user input  
                <item key="$KEY">$VALUE</item> 
        </data-collected>
        <state>$state</state> // the state in available_next_states that satisfy the condition
        <reply>$generated_reply</reply>  // the text generated by you, according to the reply style and reply example
</response>
---Example Input---
current_state:
  name: "wait_user_input"
  description: "wait user input information"
  data_collected:
    - key: "user_name"
      value: "bob"
  data_need_to_collect:
	- key: "product_name"
	  type: "str"
	- key: "product_code"
	  type: "str"
flow_of_states_and_conditions:
  - state:
      name: "wait_user_input"
      description: "wait user input information"
      is_need_reply: "true"
      reply_style: "politely ask user to providing information"
      reply_example: "Hi, could you provide some information about your product?"
      condition: "1. if user input invalid information, 2. The user still has some information list in data_need_to_collected not provided"
  - state:
      name: "complete"
      description: "user complete all process"
      is_need_reply: "true"
      reply_style: "thanks user"
      reply_example: "Thank you very much, you have all set"
      condition: "1. user providing all information list in date_need_to_collected"
history: 
user_input: "my product name is google, and the code is 92100"
--- Example Output ---
<response>
	<data-collected>  
		<item key="product_name">google</item> 
		<item key="product_code">92100</item>
	</data-collected>
	<state>complete</state>
	<reply>Thank you, you have done all the operations</reply> 
</response>
---End of Example---
---User Input---
{{ user_input }}
{% endautoescape %}
---Here is your Response---  